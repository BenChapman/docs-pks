---
title: Configure PKS API Access
owner: PKS
---

<strong><%= modified_date %></strong>

This topic describes how to configure access to the Pivotal Container Service (PKS) API.
See [PKS API Authentication](about-pks-api.html) for more information about how the PKS API and UAA interact with your PKS deployment.

##<a id='routing'></a> Configure Routing to the PKS API

To configure routing to the PKS API, perform the following steps:

1. Configure an external load balancer to forward traffic to the PKS API endpoint.
For more information, see the Configure External Load Balancer section of <em>Installing and Configuring PKS on [GCP](installing-pks-gcp.html#loadbalancer-pks-api) or [vSphere](installing-pks-vsphere.html#loadbalancer-pks-api)</em>.
  <p class="note"><strong>Note</strong>: If your PKS installation is integrated with NSX-T, map the external load balancer to the DNAT IP address assigned in the <a href="installing-nsx-t.html#apply-changes">Apply Changes and Retrieve the PKS Endpoint</a> section of <em>Installing and Configuring PKS with NSX-T Integration</em>.</p>

1. Configure a DNS entry that points to the load balancer and uses the domain configured in the PKS API section of <em>Installing and Configuring PKS on [GCP](installing-pks-gcp.html#pks-api) or [vSphere](installing-pks-vsphere.html#pks-api)</em>.

##<a id='access'></a> Configure Access to the PKS API

1. Locate your Ops Manager root CA certificate.
 * If Ops Manager generated your certificate, refer to the [Retrieve the Root CA Certificate](https://docs.pivotal.io/pivotalcf/security/pcf-infrastructure/api-cert-rotation.html#certs) section of _Managing Non-Configurable TLS/SSL Certificates_.
 * If you provided your own certificate, copy and paste the certificate you entered in the **PKS API** page into a file.

1. Locate the URL of your UAA server.
You configured this URL in the UAA section of _Installing and Configuring PKS on [GCP](installing-pks-gcp.html#uaa) or [vSphere](installing-pks-vsphere.html#uaa)_.

1. Target your UAA server using `uaac target https://UAA-URL:8443 --ca-cert ROOT-CA-FILENAME`.
Replace `UAA-URL` with the URL of your UAA server and `ROOT-CA-FILENAME` with the certificate file you downloaded in the previous step.
For example:
  <pre class="terminal">
  $ uaac target api.pks.example.com:8443 --ca-cert my-cert.cert
  </pre>

1. Run `uaac token client get admin -s UAA-ADMIN-SECRET` to request a token from the UAA server.
Replace `UAA-ADMIN-SECRET` with your UAA admin secret.
Refer to **Ops Manager > Pivotal Container Service > Credentials > Uaa Admin Secret** to retrieve this value.

1. Grant cluster access to new or existing users with UAA.
See the [Grant Cluster Access](manage-users.html#uaa-scopes) section of _Managing Users in UAA_ for more information.

####<a id='access'></a> User access
Use this to log in as an individual user. This login procedure is the same for individually created users or users from external LDAP groups.

Run `pks login -a UAA-URL -u USERNAME -p PASSWORD -k` to log in to the PKS CLI.
Replace the `UAA-URL` with the URL of your UAA server, `USERNAME` with your username, and `PASSWORD` with your password.
For example:
  <pre class="terminal">
  $ pks login -a api.pks.example.com -u alana -p my-password -k
  </pre>
  
We highly recommend running the log in command without providing the password. You will be asked prompted for the password interactively, which is more secure.
  <pre class="terminal">
  $ pks login -a api.pks.example.com -u alana -k
  </pre>

####<a id='access'></a> Client credentials access
Use this to log in as an automated client, like in a script, service, etc.

Run `pks login -a UAA-URL --client-name CLIENT_NAME --client-secret CLIENT_SECRET -k` to log in to the PKS CLI.
Replace the `UAA-URL` with the URL of your UAA server, `CLIENT_NAME` with your oAuth client id, and `CLIENT_SECRET` with your oAuth client secret.
For example:
  <pre class="terminal">
  $ pks login -a api.pks.example.com --client-name automated-client --client-secret randomly-generated-secret -k
  </pre>
